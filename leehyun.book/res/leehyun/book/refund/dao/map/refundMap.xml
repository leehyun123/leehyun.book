<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="leehyun.book.refund.dao.map.RefundMap">
   <select id="getRefunds" resultMap="refundMap">
      select *
      from refunds 
      order by refund_num
   </select>
   
   <select id="getUserRefunds" parameterType="int" resultMap="refundMap">
      select refund_num, order_num, refund_date, refund_status 
      from refunds 
      join orders 
      using(order_num)
	  where user_num=#{userNum}
   </select>
    
   <insert id="addRefund" parameterType="refund">
      insert into refunds
      values(refundno_seq.nextval, #{orderNum}, #{refundDate}, #{refundStatus})
   </insert>
   
   <update id="updateRefund" parameterType="refund">
      update refunds set refund_status=#{refundStatus}
      where refund_num=#{refundNum}
   </update>

   <delete id="delRefund" parameterType="int">
      delete refunds where refund_num=#{refundNum}
   </delete>
   
   <resultMap id ="refundMap" type="refund">
      <id      property="refundNum"   column="refund_num"/>
      <result property="orderNum"    column="order_num"/>
      <result property="refundDate"   column="refund_date"/>
      <result property="refundStatus"   column="refund_status"/>
   </resultMap>
</mapper>